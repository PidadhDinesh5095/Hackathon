<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical AI Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .message {
            max-width: 60%;
            padding: 10px 15px;
            border-radius: 10px;
            margin: 5px 0;
        }
        .user {
            background-color: #007bff;
            color: white;
            align-self: flex-end;
        }
        .ai {
            background-color: transparent;
            color: black;
            align-self: flex-start;
        }
    </style>
</head>
<body class="flex flex-col h-screen bg-gray-100">

    <!-- Navbar -->
    <nav id="navbar" class="bg-blue-600 text-white p-4 flex justify-center items-center shadow-md">
        <img src="logo.jpg" alt="Logo" class="h-16 mr-4">
        <h1 id="statement" class="text-lg font-semibold text-center">Welcome to Medical AI Chat! Get instant health advice.</h1>
    </nav>

    <!-- Chat Container -->
    <div id="chat-container" class="flex flex-col flex-1 items-center relative">
        <!-- Logo and Statement (Centered Start) -->
        <div id="start-info" class="flex flex-col items-center justify-center flex-1 text-center absolute w-full">
            <img src="logo.jpg" alt="Chat Logo" class="h-24 mb-4">
            <p class="text-gray-600 text-lg font-semibold">Your AI-powered health assistant for instant medical guidance.</p>
        </div>

        <!-- Chatbox -->
        <div id="chatbox" class="overflow-y-auto p-4 flex flex-col-reverse w-3/5 mx-auto hidden h-[calc(100vh-200px)]"></div>
    </div>

    <!-- Input Area (Fixed at Bottom) -->
    <div id="input-area" class="bg-blue-200 p-4 border-t h-32 flex items-center fixed bottom-0 w-full md:w-[60%] left-1/2 transform -translate-x-1/2 border-gray-200 border">
        <input type="text" id="userMessage" class="flex-1 p-2 border rounded-lg" placeholder="Type your message..." oninput="toggleButton()">
        <button id="sendButton" onclick="sendMessage()" class="ml-2 px-4 py-2 bg-gray-500 text-white rounded-md" disabled>Ask</button>
    </div>

    <script>
        function toggleButton() {
            const input = document.getElementById("userMessage");
            const button = document.getElementById("sendButton");
            button.disabled = input.value.trim() === "";
            button.classList.toggle("bg-blue-600", input.value.trim() !== "");
            button.classList.toggle("bg-gray-500", input.value.trim() === "");
        }

        async function sendMessage() {
            const userMessage = document.getElementById("userMessage").value.trim();
            if (!userMessage) return;

            document.getElementById("start-info").style.display = "none";
            document.getElementById("chatbox").classList.remove("hidden");

            const chatbox = document.getElementById("chatbox");
            chatbox.innerHTML = `<div class='message user self-end'>${userMessage}</div>` + chatbox.innerHTML;
            document.getElementById("userMessage").value = "";
            toggleButton();

            try {
                const response = await fetch("http://localhost:3000/chat", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ userId: "123", message: userMessage })
                });

                const data = await response.json();
                chatbox.innerHTML = `<div class='message ai'>${data.reply}</div>` + chatbox.innerHTML;
            } catch (error) {
                chatbox.innerHTML = `<div class='message ai'>Sorry, an error occurred.</div>` + chatbox.innerHTML;
            }
        }
    </script>
</body>
</html>
